<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¨ì† ê²°ê³¼ í™•ì¸ ë° ìˆ˜ì •</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #27ae60;
            --danger-color: #e74c3c; /* ì œì™¸ ë²„íŠ¼ ìƒ‰ìƒ */
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px; /* í•˜ë‹¨ ë²„íŠ¼ ê³µê°„ í™•ë³´ */
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .summary-box {
            background: #e8f6f3;
            border: 1px solid #d1f2eb;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
            color: #16a085;
            font-size: 1.1rem;
        }

        .result-card {
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease; /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        }

        /* ì œì™¸ ìƒíƒœ ìŠ¤íƒ€ì¼ */
        .result-card.skipped {
            background-color: #eaeaea;
            opacity: 0.6;
            transform: scale(0.98);
        }

        .image-area {
            width: 100%;
            background: #000;
            text-align: center;
            position: relative;
        }

        .image-area img {
            max-width: 100%;
            max-height: 400px;
            display: block;
            margin: 0 auto;
        }
        
        /* ì œì™¸ë¨ ë±ƒì§€ */
        .skipped-badge {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(231, 76, 60, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 1.5rem;
            z-index: 10;
        }

        .result-card.skipped .skipped-badge {
            display: block;
        }

        .input-area {
            padding: 20px;
            background: #fff;
        }

        .result-card.skipped .input-area {
            background: #eaeaea;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: #666;
            font-weight: bold;
        }

        /* ì…ë ¥ì°½ê³¼ ì œì™¸ ë²„íŠ¼ì„ ê°€ë¡œë¡œ ë°°ì¹˜í•˜ê¸° ìœ„í•œ ë˜í¼ */
        .input-wrapper {
            display: flex;
            gap: 10px;
        }

        .plate-input {
            flex: 1; /* ë‚¨ì€ ê³µê°„ ëª¨ë‘ ì°¨ì§€ */
            padding: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 10px;
            letter-spacing: 2px;
            box-sizing: border-box;
            background-color: #fafafa;
            transition: border-color 0.3s;
        }

        .result-card.skipped .plate-input {
            text-decoration: line-through;
            color: #999;
            background-color: #ddd;
        }

        .plate-input:focus {
            border-color: var(--accent-color);
            outline: none;
            background-color: #fff;
        }

        /* ì œì™¸ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-skip {
            padding: 0 20px;
            background-color: white;
            color: var(--danger-color);
            border: 2px solid var(--danger-color);
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-skip:hover {
            background-color: var(--danger-color);
            color: white;
        }

        /* ì œì™¸ ìƒíƒœì¼ ë•Œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë°˜ì „ */
        .result-card.skipped .btn-skip {
            background-color: #555;
            border-color: #555;
            color: white;
            content: "ë³µêµ¬";
        }

        .btn-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            gap: 15px;
            backdrop-filter: blur(5px);
            z-index: 100;
            box-sizing: border-box;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            min-width: 120px;
        }

        .btn-save {
            background-color: var(--accent-color);
            color: white;
            flex: 2;
            max-width: 400px;
        }
        
        .btn-cancel {
            background-color: #95a5a6;
            color: white;
            flex: 1;
            max-width: 200px;
        }

        .helper-text {
            font-size: 0.8rem;
            color: #999;
            text-align: center;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ” ì¸ì‹ ê²°ê³¼ í™•ì¸</h1>

        <div class="summary-box">
            {{ report_text }}
        </div>

        <form action="/save" method="post" id="saveForm">
            <input type="hidden" name="location" value="{{ location }}">
            <input type="hidden" name="reason" value="{{ reason }}">
            <input type="hidden" name="report_text" value="{{ report_text }}">

            {% for result in results %}
            <div class="result-card" id="card_{{ loop.index }}">
                <div class="image-area">
                    <div class="skipped-badge">ì œì™¸ë¨</div>
                    <a href="{{ result.image_url }}" target="_blank">
                        <img src="{{ result.image_url }}" alt="ë‹¨ì† ì°¨ëŸ‰ ì‚¬ì§„">
                    </a>
                </div>

                <div class="input-area">
                    <label class="input-label">ì°¨ëŸ‰ë²ˆí˜¸</label>
                    
                    <div class="input-wrapper">
                        <input type="text" 
                               class="plate-input" 
                               id="input_{{ loop.index }}"
                               name="plate_{{ result.filename }}" 
                               value="{{ result.plate }}" 
                               placeholder="ì§ì ‘ ì…ë ¥">
                        
                        <button type="button" 
                                class="btn-skip" 
                                onclick="toggleSkip('{{ loop.index }}')">
                                ì œì™¸
                        </button>
                    </div>

                    <p class="helper-text">â€» ë²ˆí˜¸ê°€ í‹€ë¦¬ë©´ ìˆ˜ì •í•˜ê³ , ì €ì¥í•˜ì§€ ì•Šìœ¼ë ¤ë©´ [ì œì™¸]ë¥¼ ëˆ„ë¥´ì„¸ìš”.</p>
                </div>
            </div>
            {% endfor %}
            
            <div style="height: 60px;"></div>

            <div class="btn-container">
                <a href="/" class="btn btn-cancel">ì·¨ì†Œ</a>
                <button type="submit" class="btn btn-save">ğŸ’¾ ì—‘ì…€ ì €ì¥í•˜ê¸°</button>
            </div>
        </form>
    </div>

    <script>
        function toggleSkip(index) {
            const card = document.getElementById(`card_${index}`);
            const input = document.getElementById(`input_${index}`);
            const btn = card.querySelector('.btn-skip');
            
            // ì´ë¯¸ ì œì™¸ëœ ìƒíƒœë¼ë©´ -> ë³µêµ¬
            if (card.classList.contains('skipped')) {
                card.classList.remove('skipped');
                
                // ë°±ì—…í•´ë‘” ì›ë˜ ê°’ìœ¼ë¡œ ë³µì›
                // ë§Œì•½ ë°±ì—…ê°’ì´ ì—†ë‹¤ë©´ ê³µë°± ì²˜ë¦¬
                input.value = input.getAttribute('data-original') || '';
                input.readOnly = false; // ìˆ˜ì • ê°€ëŠ¥í•˜ê²Œ
                btn.innerText = "ì œì™¸";
                btn.style.backgroundColor = ""; // ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
                btn.style.borderColor = "";
            } 
            // ì¼ë°˜ ìƒíƒœë¼ë©´ -> ì œì™¸ ì²˜ë¦¬
            else {
                // í˜„ì¬ ê°’ì„ ë°±ì—… (ë³µêµ¬ë¥¼ ìœ„í•´)
                input.setAttribute('data-original', input.value);
                
                card.classList.add('skipped');
                input.value = 's'; // ì„œë²„ ì•½ì†: 's'ëŠ” ì €ì¥ ì•ˆ í•¨
                input.readOnly = true; // ìˆ˜ì • ë¶ˆê°€ëŠ¥í•˜ê²Œ
                btn.innerText = "ë³µêµ¬";
                btn.style.backgroundColor = "#555";
                btn.style.borderColor = "#555";
            }
        }

        // ì—”í„°í‚¤ ì…ë ¥ ì‹œ í¼ ì œì¶œ ë°©ì§€ (ì‹¤ìˆ˜ë¡œ ì €ì¥ë˜ëŠ” ê²ƒ ë°©ì§€)
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
            }
        });
    </script>

</body>
</html>